(function(c,b,a){function d(e){if(!e){return}if(!e.setTargetAtTime){e.setTargetAtTime=e.setTargetValueAtTime}}if(window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")){window.AudioContext=webkitAudioContext;if(!AudioContext.prototype.hasOwnProperty("createGain")){AudioContext.prototype.createGain=AudioContext.prototype.createGainNode}if(!AudioContext.prototype.hasOwnProperty("createDelay")){AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode}if(!AudioContext.prototype.hasOwnProperty("createScriptProcessor")){AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode}if(!AudioContext.prototype.hasOwnProperty("createPeriodicWave")){AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable}AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain;AudioContext.prototype.createGain=function(){var e=this.internal_createGain();d(e.gain);return e};AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay;AudioContext.prototype.createDelay=function(e){var f=e?this.internal_createDelay(e):this.internal_createDelay();d(f.delayTime);return f};AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource;AudioContext.prototype.createBufferSource=function(){var e=this.internal_createBufferSource();if(!e.start){e.start=function(f,h,g){if(h||g){this.noteGrainOn(f||0,h,g)}else{this.noteOn(f||0)}}}else{e.internal_start=e.start;e.start=function(f,h,g){if(typeof g!=="undefined"){e.internal_start(f||0,h,g)}else{e.internal_start(f||0,h||0)}}}if(!e.stop){e.stop=function(f){this.noteOff(f||0)}}else{e.internal_stop=e.stop;e.stop=function(f){e.internal_stop(f||0)}}d(e.playbackRate);return e};AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor;AudioContext.prototype.createDynamicsCompressor=function(){var e=this.internal_createDynamicsCompressor();d(e.threshold);d(e.knee);d(e.ratio);d(e.reduction);d(e.attack);d(e.release);return e};AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter;AudioContext.prototype.createBiquadFilter=function(){var e=this.internal_createBiquadFilter();d(e.frequency);d(e.detune);d(e.Q);d(e.gain);return e};if(AudioContext.prototype.hasOwnProperty("createOscillator")){AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator;AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();if(!e.start){e.start=function(f){this.noteOn(f||0)}}else{e.internal_start=e.start;e.start=function(f){e.internal_start(f||0)}}if(!e.stop){e.stop=function(f){this.noteOff(f||0)}}else{e.internal_stop=e.stop;e.stop=function(f){e.internal_stop(f||0)}}if(!e.setPeriodicWave){e.setPeriodicWave=e.setWaveTable}d(e.frequency);d(e.detune);return e}}}if(window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")){window.OfflineAudioContext=webkitOfflineAudioContext}}(window));var actx=new AudioContext();var sounds={toLoad:0,loaded:0,audioExtensions:["mp3","ogg","wav","webm"],whenLoaded:undefined,load:function(b){var a=this;a.toLoad=b.length;b.forEach(function(c){var e=c.split(".").pop();if(a.audioExtensions.indexOf(e)!==-1){var d=makeSound(c,a.loadHandler.bind(a),true,false);d.name=c;a[d.name]=d}else{console.log("File type not recognized: "+c)}})},loadHandler:function(){var a=this;a.loaded+=1;if(a.toLoad===a.loaded){a.toLoad=0;a.loaded=0;a.whenLoaded()}}};function makeSound(a,c,b,e){var d={};d.volumeNode=actx.createGain();if(!actx.createStereoPanner){d.panNode=actx.createPanner()}else{d.panNode=actx.createStereoPanner()}d.delayNode=actx.createDelay();d.feedbackNode=actx.createGain();d.filterNode=actx.createBiquadFilter();d.convolverNode=actx.createConvolver();d.soundNode=null;d.buffer=null;d.source=a;d.loop=false;d.playing=false;d.loadHandler=undefined;d.panValue=0;d.volumeValue=1;d.startTime=0;d.startOffset=0;d.playbackRate=1;d.echo=false;d.delayValue=0.3;d.feebackValue=0.3;d.filterValue=0;d.reverb=false;d.reverbImpulse=null;d.play=function(){d.startTime=actx.currentTime;d.soundNode=actx.createBufferSource();d.soundNode.buffer=d.buffer;d.soundNode.playbackRate.value=this.playbackRate;d.soundNode.connect(d.volumeNode);if(d.reverb===false){d.volumeNode.connect(d.panNode)}else{d.volumeNode.connect(d.convolverNode);d.convolverNode.connect(d.panNode);d.convolverNode.buffer=d.reverbImpulse}d.panNode.connect(actx.destination);if(d.echo){d.feedbackNode.gain.value=d.feebackValue;d.delayNode.delayTime.value=d.delayValue;d.filterNode.frequency.value=d.filterValue;d.delayNode.connect(d.feedbackNode);if(d.filterValue>0){d.feedbackNode.connect(d.filterNode);d.filterNode.connect(d.delayNode)}else{d.feedbackNode.connect(d.delayNode)}d.volumeNode.connect(d.delayNode);d.delayNode.connect(d.panNode)}d.soundNode.loop=d.loop;d.soundNode.start(0,d.startOffset%d.buffer.duration);d.playing=true};d.pause=function(){if(d.playing){d.soundNode.stop(0);
d.startOffset+=actx.currentTime-d.startTime;d.playing=false}};d.restart=function(){if(d.playing){d.soundNode.stop(0)}d.startOffset=0;d.play()};d.playFrom=function(f){if(d.playing){d.soundNode.stop(0)}d.startOffset=f;d.play()};d.setEcho=function(f,h,g){if(f===undefined){f=0.3}if(h===undefined){h=0.3}if(g===undefined){g=0}d.delayValue=f;d.feebackValue=h;d.filterValue=g;d.echo=true};d.setReverb=function(h,g,f){if(h===undefined){h=2}if(g===undefined){g=2}if(f===undefined){f=false}d.reverbImpulse=impulseResponse(h,g,f,actx);d.reverb=true};d.fade=function(f,g){if(d.playing){d.volumeNode.gain.linearRampToValueAtTime(d.volumeNode.gain.value,actx.currentTime);d.volumeNode.gain.linearRampToValueAtTime(f,actx.currentTime+g)}};d.fadeIn=function(f){d.volumeNode.gain.value=0;d.fade(1,f)};d.fadeOut=function(f){d.fade(0,f)};Object.defineProperties(d,{volume:{get:function(){return d.volumeValue},set:function(f){d.volumeNode.gain.value=f;d.volumeValue=f},enumerable:true,configurable:true},pan:{get:function(){if(!actx.createStereoPanner){return d.panValue}else{return d.panNode.pan.value}},set:function(g){if(!actx.createStereoPanner){var f=g,i=0,h=1-Math.abs(f);d.panNode.setPosition(f,i,h);d.panValue=g}else{d.panNode.pan.value=g}},enumerable:true,configurable:true}});if(b){this.loadSound(d,a,c)}if(e){this.decodeAudio(d,e,c)}return d}function loadSound(d,a,b){var c=new XMLHttpRequest();c.open("GET",a,true);c.responseType="arraybuffer";c.addEventListener("load",decodeAudio.bind(this,d,c,b));c.send()}function decodeAudio(c,b,a){actx.decodeAudioData(b.response,function(d){c.buffer=d;c.hasLoaded=true;if(a){a()}},function(d){throw new Error("Audio could not be decoded: "+d)})}function soundEffect(g,v,y,e,d,p,r,f,j,m,h,w,l,k){if(g===undefined){g=200}if(v===undefined){v=0}if(y===undefined){y=1}if(e===undefined){e="sine"}if(d===undefined){d=1}if(p===undefined){p=0}if(r===undefined){r=0}if(f===undefined){f=0}if(j===undefined){j=false}if(m===undefined){m=0}if(h===undefined){h=0}if(w===undefined){w=undefined}if(l===undefined){l=undefined}if(k===undefined){k=undefined}var s,u,q;s=actx.createOscillator();u=actx.createGain();if(!actx.createStereoPanner){q=actx.createPanner()}else{q=actx.createStereoPanner()}s.connect(u);u.connect(q);q.connect(actx.destination);u.gain.value=d;if(!actx.createStereoPanner){q.setPosition(p,0,1-Math.abs(p))}else{q.pan.value=p}s.type=e;var n;var z=function(B,A){return Math.floor(Math.random()*(A-B+1))+B};if(m>0){n=z(g-m/2,g+m/2)}else{n=g}s.frequency.value=n;if(v>0){o(u)}a(u);if(f>0){b(s)}if(w){t(u)}if(l){c(u)}if(h>0){i()}x(s);function c(B){var A=actx.createConvolver();A.buffer=impulseResponse(l[0],l[1],l[2],actx);B.connect(A);A.connect(q)}function t(D){var A=actx.createGain(),B=actx.createDelay(),C=actx.createBiquadFilter();B.delayTime.value=w[0];A.gain.value=w[1];if(w[2]){C.frequency.value=w[2]}B.connect(A);if(w[2]){A.connect(C);C.connect(B)}else{A.connect(B)}D.connect(B);B.connect(q)}function o(A){A.gain.value=0;A.gain.linearRampToValueAtTime(0,actx.currentTime+r);A.gain.linearRampToValueAtTime(d,actx.currentTime+r+v)}function a(A){A.gain.linearRampToValueAtTime(d,actx.currentTime+v+r);A.gain.linearRampToValueAtTime(0,actx.currentTime+r+v+y)}function b(B){var A=B.frequency.value;if(!j){B.frequency.linearRampToValueAtTime(A,actx.currentTime+r);B.frequency.linearRampToValueAtTime(A-f,actx.currentTime+r+v+y)}else{B.frequency.linearRampToValueAtTime(A,actx.currentTime+r);B.frequency.linearRampToValueAtTime(A+f,actx.currentTime+r+v+y)}}function i(){var C=actx.createOscillator(),B=actx.createOscillator(),A=actx.createGain(),D=actx.createGain();A.gain.value=d;D.gain.value=d;C.connect(A);A.connect(actx.destination);B.connect(D);D.connect(actx.destination);C.type="sawtooth";B.type="sawtooth";C.frequency.value=n+h;B.frequency.value=n-h;if(v>0){o(A);o(D)}if(y>0){a(A);a(D)}if(f>0){b(C);b(B)}if(w){t(A);t(D)}if(l){c(A);c(D)}x(C);x(B)}function x(A){A.start(actx.currentTime+r);A.stop(actx.currentTime+r+2)}}function impulseResponse(e,g,h,j){var b=j.sampleRate*e;var a=j.createBuffer(2,b,j.sampleRate);var d=a.getChannelData(0),k=a.getChannelData(1);for(var f=0;f<b;f++){var c;if(h){c=b-f}else{c=f}d[f]=(Math.random()*2-1)*Math.pow(1-c/b,g);k[f]=(Math.random()*2-1)*Math.pow(1-c/b,g)}return a};
